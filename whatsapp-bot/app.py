from flask import Flask, request

app = Flask(__name__)

@app.route("/webhook", methods=["POST"])  # –£–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ 
–ø—Ä–∏–Ω–∏–º–∞–µ–º —Ç–æ–ª—å–∫–æ POST-–∑–∞–ø—Ä–æ—Å—ã
def webhook():
    try:
        # –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å JSON-–¥–∞–Ω–Ω—ã–µ –æ—Ç Twilio
        data = request.get_json()
        print("üì© –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:", data)  # –í—ã–≤–æ–¥–∏–º –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª 
–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã
        if not data:
            return "‚ùå –û—à–∏–±–∫–∞: –ø—É—Å—Ç–æ–π JSON", 400

        # –ò–∑–≤–ª–µ–∫–∞–µ–º —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –Ω–æ–º–µ—Ä –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
        message_body = data.get("Body", "–ù–µ—Ç —Ç–µ–∫—Å—Ç–∞")  # –ò–∑–≤–ª–µ–∫–∞–µ–º 
—Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
        sender_number = data.get("From", "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å")  
# –ò–∑–≤–ª–µ–∫–∞–µ–º –Ω–æ–º–µ—Ä

        print(f"üì® –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç {sender_number}: {message_body}")  
# –õ–æ–≥ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª

        return "‚úÖ OK", 200  # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º Twilio —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç
    except Exception as e:
        print("‚ùå –û—à–∏–±–∫–∞:", e)
        return "‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞", 400

if __name__ == "__main__":
    app.run(port=5000, debug=True)
